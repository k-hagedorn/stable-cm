This is a custom implementation of https://arxiv.org/pdf/2410.11081
Sampling function is still missing 

